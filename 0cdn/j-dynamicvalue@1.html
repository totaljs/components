<style>.ui-dynamicvalue-label{margin-bottom:5px;font-size:12px;text-align:left}.ui-dynamicvalue-label i{margin-right:5px}.ui-dynamicvalue{height:32px;border:1px solid #E0E0E0;border-radius:3px}.ui-dynamicvalue-value{cursor:pointer;display:block;padding:8px 7px 0 5px;margin-right:32px;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;font:normal 14px Arial;color:gray}.ui-dynamicvalue-icon{color:black;cursor:pointer;width:32px;float:right;border-left:1px solid #E0E0E0;height:30px;text-align:center;padding:5px 0 0}.ui-dynamicvalue-is .ui-dynamicvalue-value{color:black}.ui-dynamicvalue-is .fa-times{color:red}.ui-dynamicvalue-required .ui-dynamicvalue-label{font-weight:bold}.ui-dynamicvalue-required .ui-dynamicvalue-label:before{color:red;content:'***';margin-right:5px}.ui-dynamicvalue-required .ui-dynamicvalue-icon{border-left-color:#D0D0D0}.ui-dynamicvalue-required .ui-dynamicvalue{border-color:#D0D0D0}.ui-dynamicvalue-invalid .ui-dynamicvalue{border:1px solid red}.ui-dynamicvalue-invalid .ui-dynamicvalue-icon{border-left-color:red;color:red}.ui-disabled .ui-dynamicvalue *{cursor:not-allowed}.ui-disabled .ui-dynamicvalue{background-color:#F0F0F0}.ui-disabled .ui-dynamicvalue-value{color:gray}.ui-disabled .ui-dynamicvalue-icon i{color:gray !important}.ui-dark .ui-dynamicvalue{border-color:#3A3A3A;background-color:#202020;color:#707070}.ui-dark .ui-dynamicvalue-icon{border-left-color:#3A3A3A;color:#707070}.ui-dark .ui-dynamicvalue-is .ui-dynamicvalue-value{color:white}.ui-dark .ui-dynamicvalue-required .ui-dynamicvalue-label:before{color:red}.ui-dark .ui-dynamicvalue-required .ui-dynamicvalue-icon{border-color:#424242}.ui-dark .ui-dynamicvalue-required .ui-dynamicvalue{border-color:#424242}.ui-dark .ui-dynamicvalue-invalid .ui-dynamicvalue{border-color:red !important;background-color:#202020 !important}.ui-dark .ui-dynamicvalue-invalid .ui-dynamicvalue-icon{border-left-color:red;color:red}.ui-dark .ui-disabled .ui-dynamicvalue{background-color:#282828}.ui-dark .ui-disabled .ui-dynamicvalue-value{color:#777777}</style>
<script>COMPONENT('dynamicvalue@1','html:{{ name}};icon2:search;loading:true',function(self,config){var cls='ui-dynamicvalue';self.readonly();self.nocompile();self.bindvisible(50);self.validate=function(value){return!config.required||config.disabled?true:!!value};self.state=function(type){if(!type)return;var invalid=config.required?self.isInvalid():false;if(invalid===self.$oldstate)return;self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)};self.configure=function(key,value){switch(key){case'html':config.html=Tangular.compile(value);break;case'label':var label=self.find('.'+cls+'-label');label.tclass('hidden',!value);label.find('span').html((value||'')+':');break;case'required':self.noValid(!value);!value&&self.state(1,1);self.tclass(cls+'-required',value);break;case'disabled':self.tclass('ui-disabled',value);break;case'icon':var fa=self.find('.'+cls+'-label').find('i');fa.rclass2('fa-').rclass('hidden');if(value)fa.aclass('fa-'+value);else fa.aclass('hidden');break;case'remap':config.remap=value?FN(value):null;break}};self.make=function(){if(!config.label)config.label=self.html();self.aclass(cls+'-container');self.html('<div class="{2}-label{3}"><i class="fa hidden"></i><span>{1}:</span></div><div class="{2}"><div class="{2}-icon"><i class="fa fa-times"></i></div><div class="{2}-value">{0}</div></div>'.format(config.placeholder,config.label,cls,config.label?'':' hidden'));self.event('click','.'+cls,function(){!config.disabled&&EXEC(config.click,self.element,function(value){self.set(value);self.change();config.required&&setTimeout(self.validate2,100)},self.get())});self.event('click','.fa-times',function(e){e.preventDefault();e.stopPropagation();if(!config.disabled){self.change();self.set(null)}})};self.bindvalue=function(value){if(config.remap)value=config.remap(value);self.tclass(cls+'-is',!!value);var fa=self.find('.'+cls+'-icon').find('i');fa.rclass2('fa-');if(value)fa.aclass('fa-times');else fa.aclass('fa-'+config.icon2);var val=value?config.html(value):config.placeholder;var body=self.find('.'+cls+'-value');if(body.html()!==val)body.html(val);config.loading&&SETTER('loading','hide',200)};self.setter=function(value,path,type){if(value){if(config.url){config.loading&&SETTER('loading','show');AJAX('GET '+config.url.arg({value:encodeURIComponent(value)}),self.bindvalue)}else EXEC(config.exec,value,self.bindvalue,type)}else self.bindvalue(value)}});</script>