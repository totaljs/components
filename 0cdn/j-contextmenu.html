<style>.ui-contextmenu{position:absolute;opacity:0;transition:0.25s transform cubic-bezier(0.23,1,0.32,1);left:-100;top:-100;z-index:20;width:200px;box-shadow:0 2px 15px rgba(0,0,0,0.05);transform:translate(0px,20px);background-color:#FFF;border-radius:4px;border:1px solid #E0E0E0}.ui-contextmenu .selected{font-weight:bold}.ui-contextmenu .selected *{color:#1484FC !important}.ui-contextmenu-arrow{position:absolute;top:-10px;left:107px;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-bottom:10px solid #E0E0E0}.ui-contextmenu-arrow:before{content:' ';position:absolute;width:0;height:0;margin-top:2px;margin-left:-8px;border-left:8px solid transparent;border-right:8px solid transparent;border-bottom:8px solid #FFF}.ui-contextmenu-visible{opacity:1;transform:translate(0px,0px)}.ui-contextmenu-items>div{border-top:1px solid #F0F0F0;font-size:12px;height:28px;background-color:#FFF;cursor:pointer}.ui-contextmenu-items>div:hover{background:linear-gradient(white,#F8F8F8)}.ui-contextmenu-items i{float:left;width:30px;text-align:center;padding:7px 0 3px;font-size:14px;color:#A0A0A0}.ui-contextmenu-items span{float:left;color:#000;width:140px;margin:6px 0 0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}.ui-contextmenu-items>div:first-child{border-width:0;border-top-left-radius:var(--radius);border-top-right-radius:var(--radius)}.ui-contextmenu-items>div:last-child{border-bottom-left-radius:var(--radius);border-bottom-right-radius:var(--radius)}</style>
<script>COMPONENT('contextmenu',function(self){var is=false,timeout,container,arrow;self.template=Tangular.compile('<div data-index="{{ index}}"{{ if selected}} class="selected"{{ fi}}><i class="ti {{ icon}}"></i><span>{{ name | raw}}</span></div>');self.singleton();self.readonly();self.nocompile&&self.nocompile();self.callback=null;self.items=EMPTYARRAY;self.make=function(){self.aclass('ui-contextmenu hidden');self.append('<span class="ui-contextmenu-arrow"></span><div class="ui-contextmenu-items"></div>');container=self.find('.ui-contextmenu-items');arrow=self.find('.ui-contextmenu-arrow');self.event('touchstart mousedown','div[data-index]',function(e){self.callback&&self.callback(self.items[+$(this).attrd('index')],$(self.target));self.hide();e.preventDefault();e.stopPropagation()});var fn=function(){is&&self.hide(1)};$(window).on('scroll',fn);self.event('scroll',fn);self.on('reflow',fn);self.on('scroll',fn);$(document).on('touchstart mousedown',function(e){if(is&&(self.target!==e.target&&!self.target.contains(e.target)))self.hide(1)})};self.show=function(orientation,target,items,callback,offsetX,offsetY){if(is){clearTimeout(timeout);var obj=target instanceof jQuery?target[0]:target;if(self.target===obj){self.hide(0);return}}target=$(target);var type=typeof(items);var item;if(type==='string')items=self.get(items);else if(type==='function'){callback=items;items=(target.attrd('options')||'').split(';');for(var i=0,length=items.length;i<length;i++){item=items[i];if(!item)continue;var val=item.split('|');items[i]={name:val[0],icon:val[1],value:val[2]||val[0]}}}if(!items){self.hide(0);return}self.callback=callback;var builder=[];for(var i=0,length=items.length;i<length;i++){item=items[i];item.index=i;if(item.icon){if(item.icon.substring(0,3)!=='ti-')item.icon='ti-'+item.icon}else item.icon='ti-caret-right';builder.push(self.template(item))}self.items=items;self.target=target[0];var offset=target.offset();container.html(builder);switch(orientation){case'left':arrow.css({left:'15px'});break;case'right':arrow.css({left:'165px'});break;case'center':arrow.css({left:'90px'});break}var options={left:orientation==='center'?Math.ceil((offset.left-self.element.width()/2)+(target.innerWidth()/2)):orientation==='left'?(offset.left-8)+(offsetX||0):(offset.left-self.element.width())+target.innerWidth()+(offsetX||0)+8,top:offset.top+target.innerHeight()+10+(offsetY||0)};self.css(options);if(is)return;self.rclass('hidden');setTimeout(function(){self.aclass('ui-contextmenu-visible');self.emit('contextmenu',true,self,self.target)},100);is=true};self.hide=function(sleep){if(!is)return;clearTimeout(timeout);timeout=setTimeout(function(){self.aclass('hidden').rclass('ui-contextmenu-visible');self.emit('contextmenu',false,self,self.target);self.callback=null;self.target=null;is=false},sleep?sleep:100)}});</script>