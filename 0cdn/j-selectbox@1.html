<style>.ui-selectbox{border:1px solid #E0E0E0;font-size:14px;color:#000}.ui-selectbox-container{position:relative;left:0;right:0;overflow:hidden}.ui-selectbox-area{height:100%;position:absolute;left:0;right:0;overflow:hidden}.ui-selectbox-container .ui-selectbox-area:last-child{left:50%}.ui-selectbox .ui-selectbox-body{list-style-type:none;width:100%;height:100%;float:left;overflow:auto;margin:0;padding:0;background-color:#FFF;border-left:1px solid #E0E0E0;font-weight:bold;overflow-y:scroll;-ms-overflow-style:none;scrollbar-width:none}.ui-selectbox .ui-selectbox-body::-webkit-scrollbar{display:none}.ui-selectbox .ui-selectbox-area:first-child .ui-selectbox-body{border-left:0;font-weight:normal}.ui-selectbox .ui-selectbox-body span{border-bottom:1px solid #E0E0E0;padding:5px 10px;cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;color:#000}.ui-selectbox .ui-selectbox-body span:hover{background-color:#F0F0F0;text-decoration:none}.ui-selectbox-selected{color:#A0A0A0 !important}.ui-selectbox-search{border-bottom:1px solid #E0E0E0;height:34px;background-color:#FFF}.ui-selectbox-search input{width:100%;outline:0;background-color:#FFF;font:normal normal 12px Arial;border:0;margin:0;padding:0;height:33px;line-height:33px}.ui-selectbox-search span{float:left;width:30px;text-align:center;height:33px;line-height:33px;font-size:12px;color:#A0A0A0}.ui-selectbox-search .fa-times{color:red;cursor:pointer}.ui-selectbox-search div{margin-left:30px}.ui-selectbox-invalid{border-color:#E1A1A1;background-color:#FFF3F3 !important}.ui-selectbox-invalid .ui-selectbox-search{border-color:#E1A1A1}.ui-selectbox.ui-disabled input{background-color:#F0F0F0;color:gray}.ui-selectbox.ui-disabled .ui-selectbox-search{background-color:#F0F0F0}.ui-selectbox.ui-disabled .ui-selectbox-body{color:gray;overflow:hidden}.ui-selectbox.ui-disabled .ui-selectbox-body span:hover{background-color:#FFF !important}.ui-dark .ui-selectbox-search{border-bottom-color:#3A3A3A;background-color:#202020}.ui-dark .ui-selectbox-search span{background-color:#202020}.ui-dark .ui-selectbox-search input{background-color:#202020;color:#FFF}.ui-dark .ui-selectbox{border-color:#3A3A3A;background-color:#202020}.ui-dark .ui-selectbox .ui-selectbox-body{border-left-color:#3A3A3A;background-color:#202020}.ui-dark .ui-selectbox .ui-selectbox-body span{border-bottom-color:#3A3A3A;color:#FFF}.ui-dark .ui-selectbox .ui-selectbox-body span:hover{background-color:#303030 !important}.ui-dark .ui-selectbox-invalid{border-color:red;background-color:#202020 !important}</style>
<script>COMPONENT('selectbox@1',function(self,config,cls){var cls2='.'+cls,Eitems,Eselected,datasource,condition;self.datasource=EMPTYARRAY;self.template=Tangular.compile('<span data-search="{{ search}}" data-index="{{ index}}">{{ text}}</span>');self.nocompile&&self.nocompile();self.validate=function(value){return config.disabled||!config.required?true:value&&value.length>0};self.configure=function(key,value){var redraw=false;switch(key){case'type':self.type=value;break;case'disabled':self.tclass('ui-disabled',value);self.find('input').prop('disabled',value);if(value)self.rclass(cls+'-invalid');else if(config.required)self.state(1,1);break;case'if':condition=value?FN(value):null;break;case'required':!value&&self.state(1,1);break;case'height':case'search':redraw=true;break;case'items':var arr=[];value.split(',').forEach(function(item){item=item.trim().split('|');var obj={};obj.name=item[0].trim();obj.id=(item[1]==null?item[0]:item[1]).trim();if(config.type==='number')obj.id=+obj.id;arr.push(obj)});self.bind('',arr);break;case'datasource':datasource&&self.unwatch(datasource,self.bind);self.watch(value,self.bind,true);datasource=value;break}redraw&&self.redraw()};self.search=function(){var search=config.search?self.find('input').val().toSearch():'';self.find(cls2+'-main').find('span').each(function(){var el=$(this);el.tclass('hidden',el.attrd('search').indexOf(search)===-1)});self.find(cls2+'-search-icon').tclass('fa-search',search.length===0).tclass('fa-times',search.length>0)};self.redraw=function(){self.html((typeof(config.search)==='string'?'<div class="{0}-search"><span><i class="fa fa-search {0}-search-icon"></i></span><div><input type="text" placeholder="{1}" /></div></div><div>'.format(cls,config.search):'')+'<div class="{0}-container" style="height:{1}px"><div class="{0}-area {0}-main"><div class="{0}-body noscrollbar"></div></div><div class="{0}-area"><div class="{0}-body noscrollbar" style="height:{1}px"></div></div></div>'.format(cls,config.height||'200'));self.find(cls2+'-body').each(function(index){if(index)Eselected=$(this);else Eitems=$(this)})};self.bind=function(path,value){var kt=config.text||'name',kv=config.value||'id',builder=[];self.datasource=[];if(value){var index=0;for(var i=0;i<value.length;i++){var item=value[i];if(condition&&!condition(item))continue;var text,val;if(typeof(item)==='string'){text=item;val=self.parser(item)}else{text=item[kt];val=item[kv]}item={text:text,value:val,index:index++,search:text.toSearch()};self.datasource.push(item);builder.push(self.template(item))}}Eitems.empty().append(builder.join(''));self.refresh();self.search()};self.make=function(){self.aclass(cls);self.redraw();config.datasource&&self.reconfigure('datasource:'+config.datasource);config.items&&self.reconfigure('items:'+config.items);self.event('click','span[data-index]',function(){if(config.disabled)return;var selected=self.get()||[];var index=+this.getAttribute('data-index');var value=self.datasource[index];if(selected.indexOf(value.value)===-1)selected.push(value.value);else selected=selected.remove(value.value);self.set(selected);self.change(true)});self.event('click','.fa-times',function(){if(!config.disabled){self.find('input').val('');self.search()}});typeof(config.search)==='string'&&self.event('keydown','input',function(){!config.disabled&&setTimeout2(self.id,self.search,500)})};self.setter=function(value,path,type){var selected={},builder=[],ds=self.datasource,dsl=ds.length;if(value){for(var i=0,length=value.length;i<length;i++){for(var j=0;j<dsl;j++){if(ds[j].value===value[i]){selected[j]=true;builder.push(self.template(ds[j]))}}}}Eitems.find('span').each(function(){var el=$(this);var index=+el.attrd('index');el.tclass(cls+'-selected',selected[index]!==undefined)});Eselected.empty().append(builder.join(''));self.search();if(type!==1){setTimeout(function(){Eitems[0].scrollTop=0},500)}};self.state=function(type){if(type){var invalid=config.required?self.isInvalid():false;if(invalid!==self.$oldstate){self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)}}}});</script>